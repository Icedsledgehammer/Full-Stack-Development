<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guess the Card</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body class="bg-light">
    <video autoplay loop muted class="background-video">
        <source src="video.mp4" type="video/mp4">
        Your browser does not support the video tag.
    </video>
    
    <div class="container text-center py-5">
        <h1 class="mb-4" style="color: red;">Find the Matching Card!</h1>
        <div id="target-card" class="mb-4"></div>
        
        <div class="row justify-content-center" id="card-container">
            <!-- Cards will be dynamically inserted here -->
        </div>

        <div id="result" class="h3 mt-4"></div>
        <button onclick="location.reload()" class="btn btn-primary mt-3">Refresh Game</button>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(async function() {
            // Get new deck and draw 3 cards
            const deckResponse = await fetch('https://deckofcardsapi.com/api/deck/new/shuffle/?deck_count=1');
            const deckData = await deckResponse.json();
            const drawResponse = await fetch(`https://deckofcardsapi.com/api/deck/${deckData.deck_id}/draw/?count=3`);
            const cardsData = await drawResponse.json();
            const cards = cardsData.cards;

            // Shuffle the cards array
            cards.sort(() => Math.random() - 0.5);

            // Select random target card
            const targetCard = cards[Math.floor(Math.random() * cards.length)];
            $('#target-card').html(`
                <img src="${targetCard.image}" alt="Target Card" 
                     class="target-card-img img-fluid rounded shadow">
            `);

            // Generate card elements
            const cardContainer = $('#card-container');
            cards.forEach((card, index) => {
                cardContainer.append(`
                    <div class="col-md-4 mb-4">
                        <div class="flip-box" data-card-code="${card.code}">
                            <div class="flip-box-inner">
                                <div class="flip-box-front">
                                    <img src="https://deckofcardsapi.com/static/img/back.png" 
                                         alt="Card Back" class="img-fluid">
                                </div>
                                <div class="flip-box-back">
                                    <img src="https://deckofcardsapi.com/static/img/back.png" 
                                         alt="Hidden Card" class="img-fluid">
                                </div>
                            </div>
                        </div>
                    </div>
                `);
            });

            let hasGuessed = false;

            // Handle card clicks
            $('.flip-box').click(function() {
                if (hasGuessed) return;
                hasGuessed = true;
                
                $(this).find('.flip-box-back img').attr('src', cards.find(card => card.code === $(this).data('card-code')).image);
                const isCorrect = $(this).data('card-code') === targetCard.code;
                const result = $('#result');
                
                if (isCorrect) {
                    result.html('üéâ Correct! Well done! üå∏').css('color', 'green');
                } else {
                    result.html('‚ùå Wrong! Refresh to try again!').css('color', 'red');
                }
                
                $('.flip-box').off('click');
            });
        });
    </script>
</body>
</html>

<style>
.background-video {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    z-index: -1;
}
</style>
